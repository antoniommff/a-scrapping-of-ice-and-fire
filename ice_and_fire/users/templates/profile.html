{% extends 'base.html' %}

{% block title %}
    <title>Mi Perfil</title>
{% endblock title %}

{% block content %}
<section class="py-4 py-xl-5">
    <div class="container">
        <h2 style="text-align: center;"><strong>Mi Perfil</strong></h2>
    </div>

    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card">
                <div class="card-body">
                    <div class="mb-3">
                        <label for="name_surname" class="fw-bold">Nombre y Apellidos</label>
                        <input type="text" class="form-control" id="name_surname" value="{{ user.name }} {{ user.surname }}" readonly>
                    </div>

                    <div class="mb-3">
                        <label for="username" class="fw-bold">Nombre de usuario</label>
                        <input type="text" class="form-control" id="username" value="{{ user.username }}" readonly>
                    </div>

                    <div class="mb-3">
                        <label for="email" class="fw-bold">Correo electrónico</label>
                        <input type="text" class="form-control" id="email" value="{{ user.email }}" readonly>
                    </div>
                </div>
            </div>

            <div class="d-grid gap-2 mt-3">
                <a href="{% url 'edit_profile' %}" class="btn btn-primary">Editar Perfil</a>
            </div>

        </div>
    </div>
</div>
<script>
    document.getElementById('confirmDelete').addEventListener('click', function() {
        fetch("{% url 'delete_account' %}", {
            method: 'POST',
            headers: {
                'X-CSRFToken': '{{ csrf_token }}',
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({})
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                window.location.href = "{% url 'login' %}";
            } else {
                alert('Error al eliminar cuenta y cerrar sesión.');
            }
        });
    });
</script>
{% endblock %}